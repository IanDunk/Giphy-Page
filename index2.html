<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <!-- Bootstrap File -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery.js"></script>

    <!-- css: reset, style -->
    <link rel="stylesheet" type="text/css" href="assets/css/reset.css">
    <!-- Isn't necessary because bootstrap has its own reset.css, however it still looks different without it? -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">

</head>

<body>

    <div class="container">
        <h1>Animal Search</h1>

        <div id="animals-view"></div>

        <div id="buttons-view"></div>
        <!-- put this on the bottom later -->

        <form id="animal-form">
            <label for="animal-input">Add an Animal Bro</label>
            <input type="text" id="animal-input">
            <br>

            <input id="find-animal" type="submit" value="Animal Search">
        </form>


        <script>

            var animals = ["Cat", "Dog", "Bird", "Beaver", "Platypus"];

            // ---------------------------------------------

            // Display Info

            function displayAnimalInfo() {
                var animal = $(this).attr("data-name");
                // constructing URL
                var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=WOaFdtza6XVcrCuwcwTMkOM7JLBjEY1v&q=" + animal + "&limit=25&offset=0&rating=G&lang=en"; // part after animal may not be needed

                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).done(function (response) {
                    // Clearing animals-view
                    $("#animals-view").empty();

                    // Loop to make 10 gifs
                    for (var i = 0; i < 10; i++) {

                        var animalDiv = $("<div class='animalGif'>");

                        var pRating = $("<p>").text("Rated: " + response.data[i].rating);
                        animalDiv.append(pRating);

                        var pGif = $("<img>").attr("src", response.data[i].images.original.url);
                        pGif.attr("data-reverse", response.data[i].images.original_still.url);
                        animalDiv.append(pGif);

                        $("#animals-view").append(animalDiv);
                    }
                });
            }

            // Checks if an img clicked, runs function
            $('body').on('click', 'img', function () {  // HERE NOW ONLY FOR TEST MOVE TO BOTTOM LATER

                var reverseData = $(this).data().reverse;
                $(this).data("reverse", this.src);
                this.src = reverseData;
            });


            // ---------------------------------------------

            // Render Buttons

            function renderButtons() {
                $("#buttons-view").empty();

                for (var i = 0; i < animals.length; i++) {
                    var a = $("<button>");

                    a.addClass("animal");
                    a.attr("data-name", animals[i]);
                    a.text(animals[i]);
                    $("#buttons-view").append(a);
                }
            }

            // ---------------------------------------------

            // Trigger AJAX call on click

            $("#find-animal").on("click", function (event) {

                event.preventDefault();
                var animal = $("#animal-input").val().trim();
                animals.push(animal);

                renderButtons();
            });

            // ---------------------------------------------

            $(document).on("click", ".animal", displayAnimalInfo);

            renderButtons();

        </script>
    </div>
</body>

</html>